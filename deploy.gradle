//deploy configuration
remotes {
    mipt {
        knownHosts = allowAnyHosts
        role 'webServers'
        host = 'npm.mipt.ru'
        user = findProperty('npm.user')
        password = findProperty('npm.pass')
    }
}

task copyPdf(dependsOn: ":build", type: Copy){
    group 'html'
    from "build/pdf/maint.pdf"
    into "build/html"
}

task deploy(dependsOn: ":copyPdf") {
    group 'html'
    doLast {
        println "Starting deploy"
        ssh.run {
            session(remotes.mipt) {
                for (f in new File(buildDir,"html").listFiles()) {
                    put from: f, into: '/var/www/books/lab-intro', fileTransfer: 'scp'
                }
            }
        }
    }
}